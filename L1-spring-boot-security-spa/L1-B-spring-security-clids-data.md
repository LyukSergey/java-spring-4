### \#\# –°–ª–∞–π–¥ 1: –¢–∏—Ç—É–ª—å–Ω–∏–π

# **Spring Security: –°—É—á–∞—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –∑–∞—Ö–∏—Å—Ç—É –¥–æ–¥–∞—Ç–∫—ñ–≤ –∑ Keycloak**

### *–í—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–æ –∑–∞—Ö–∏—Å—Ç—É API*

---

### \#\# –°–ª–∞–π–¥ 2: –ü–ª–∞–Ω –ª–µ–∫—Ü—ñ—ó

1.  **–û—Å–Ω–æ–≤–∏ –±–µ–∑–ø–µ–∫–∏:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è vs. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è.
2.  **–°—É—á–∞—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:** –†–æ–ª—å JWT, OAuth2 —Ç–∞ OIDC.
3.  **–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª —Ç–æ–∫–µ–Ω—ñ–≤:** Access —Ç–∞ Refresh —Ç–æ–∫–µ–Ω–∏.
4.  **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ Keycloak:** –Ø–∫ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å Front-End, Back-End —Ç–∞ Keycloak.
5.  **–†–æ–∑–±—ñ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Spring Boot:**
    * **–ì–ª–∏–±–æ–∫–µ –∑–∞–Ω—É—Ä–µ–Ω–Ω—è: –ú–∞–≥—ñ—è `issuer-uri`**.
    * –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ä–æ–ª–µ–π (`JwtAuthenticationConverter`).
    * CORS —Ç–∞ –π–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è.

---

### \#\# –°–ª–∞–π–¥ 3: –û—Å–Ω–æ–≤–∏ –ë–µ–∑–ø–µ–∫–∏: –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è vs. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è

–¶–µ –¥–≤–∞ —Ä—ñ–∑–Ω—ñ, –∞–ª–µ –ø–æ–≤'—è–∑–∞–Ω—ñ –ø–æ–Ω—è—Ç—Ç—è.

* üîë **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (Authentication) ‚Äî "–•—Ç–æ –≤–∏?"**

    * –¶–µ –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ—Å–æ–±–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–¥–∞—î —Å–≤–æ—ó –¥–∞–Ω—ñ (–Ω–∞–ø—Ä., –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å), –∞ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –≤–æ–Ω–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ.
    * **–ê–Ω–∞–ª–æ–≥—ñ—è:** –í–∏ –ø–æ–∫–∞–∑—É—î—Ç–µ –ø–∞—Å–ø–æ—Ä—Ç –Ω–∞ –≤—Ö–æ–¥—ñ.

* üìú **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (Authorization) ‚Äî "–©–æ –≤–∞–º –¥–æ–∑–≤–æ–ª–µ–Ω–æ —Ä–æ–±–∏—Ç–∏?"**

    * –¶–µ –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É –≤–∂–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –ø–µ–≤–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É.
    * **–ê–Ω–∞–ª–æ–≥—ñ—è:** –ü—ñ—Å–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–∞—Å–ø–æ—Ä—Ç–∞ –≤–∞–º –≤–∏–¥–∞—é—Ç—å –∫–ª—é—á-–∫–∞—Ä—Ç—É, —è–∫–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –ª–∏—à–µ –ø–µ–≤–Ω—ñ –¥–≤–µ—Ä—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∞—à –Ω–æ–º–µ—Ä —É –≥–æ—Ç–µ–ª—ñ, –∞–ª–µ –Ω–µ –Ω–æ–º–µ—Ä —Å—É—Å—ñ–¥–∞).

**Spring Security –∫–µ—Ä—É—î –æ–±–æ–º–∞ –ø—Ä–æ—Ü–µ—Å–∞–º–∏.**

---

### \#\# –°–ª–∞–π–¥ 4: –°—É—á–∞—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥: JWT, OAuth2 —Ç–∞ OIDC

* **JWT (JSON Web Token):** –¶–µ –≤–∞—à "—Ü–∏—Ñ—Ä–æ–≤–∏–π –ø–∞—Å–ø–æ—Ä—Ç". –ö–æ–º–ø–∞–∫—Ç–Ω–∏–π, —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–Ω—ñ–π —Ç–æ–∫–µ–Ω, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (claims) –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –π–æ–≥–æ –ø—Ä–∞–≤–∞. –í—ñ–Ω –º–∞—î —Ü–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å, —â–æ –≥–∞—Ä–∞–Ω—Ç—É—î –π–æ–≥–æ –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å.

* **OAuth2:** –¶–µ –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –í—ñ–Ω –≤–∏–∑–Ω–∞—á–∞—î –ø—Ä–∞–≤–∏–ª–∞, –∑–∞ —è–∫–∏–º–∏ –æ–¥–∏–Ω –¥–æ–¥–∞—Ç–æ–∫ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ–∑–≤—ñ–ª –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ —ñ–Ω—à–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–µ –∑–Ω–∞—é—á–∏ –π–æ–≥–æ –ø–∞—Ä–æ–ª—å.

* **OIDC (OpenID Connect):** –¶–µ —à–∞—Ä **–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**, –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –ø–æ–≤–µ—Ä—Ö OAuth2. –í—ñ–Ω –¥–æ–¥–∞—î –¥–æ OAuth2 **ID Token** ‚Äî —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π JWT, —è–∫–∏–π –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –æ—Å–æ–±—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

---
### ## –ö—Ä–æ–∫ 1: –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (–í–∏ —ñ Google)

–ö–æ–ª–∏ –≤–∏ –±–∞—á–∏—Ç–µ –≤—ñ–∫–Ω–æ –≤—Ö–æ–¥—É Google, –≤–∏ –≤–∑–∞—î–º–æ–¥—ñ—î—Ç–µ **–ª–∏—à–µ –∑ —Å–µ—Ä–≤–µ—Ä–æ–º Google**. 
–î–æ–¥–∞—Ç–æ–∫ "X" –Ω–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞—î –ø—Ä–æ –≤–∞—à –ø–∞—Ä–æ–ª—å.

* **–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è:** –í–∏ –≤–≤–æ–¥–∏—Ç–µ —Å–≤—ñ–π –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å.
* **Google** –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ —Ü–µ —Å–ø—Ä–∞–≤–¥—ñ –≤–∏.
* **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏ —É—Å–ø—ñ—à–Ω–æ **–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞–ª–∏—Å—è** –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ Google.

–ù–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –º–∏ —â–µ –Ω–µ –≥–æ–≤–æ—Ä–∏–º–æ –ø—Ä–æ OAuth2 —á–∏ OIDC. –¶–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –≤—Ö—ñ–¥ —É –≤–∞—à –∞–∫–∞—É–Ω—Ç.

---
### ## –ö—Ä–æ–∫ 2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (–í–∏, Google —ñ –î–æ–¥–∞—Ç–æ–∫ "X")

–¢–µ–ø–µ—Ä –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –º–∞–≥—ñ—è OAuth2. 
–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ Google –ø–µ—Ä–µ–∫–æ–Ω–∞–≤—Å—è, —â–æ —Ü–µ –≤–∏, –≤—ñ–Ω –ø–æ–∫–∞–∑—É—î –≤–∞–º –µ–∫—Ä–∞–Ω –∑–≥–æ–¥–∏:

> "–î–æ–¥–∞—Ç–æ–∫ 'X' —Ö–æ—á–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö Google –§–æ—Ç–æ. **–î–æ–∑–≤–æ–ª–∏—Ç–∏?**"

* **–í–∏ –Ω–∞—Ç–∏—Å–∫–∞—î—Ç–µ –∫–Ω–æ–ø–∫—É "–î–æ–∑–≤–æ–ª–∏—Ç–∏".**
* **–©–æ —Ü–µ –æ–∑–Ω–∞—á–∞—î:** –í–∏, —è–∫ –≤–ª–∞—Å–Ω–∏–∫ —Ä–µ—Å—É—Ä—Å—É (—Ñ–æ—Ç–æ), –¥–∞—î—Ç–µ **–¥–æ–∑–≤—ñ–ª** 
(–∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç–µ) –¥–æ–¥–∞—Ç–∫—É "X" –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –Ω—å–æ–≥–æ.
* **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Google –≤–∏–¥–∞—î –¥–æ–¥–∞—Ç–∫—É "X" —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π 
* **Access Token** ‚Äî —Ü–µ —ñ —î —Ç–æ–π —Å–∞–º–∏–π "–∫–ª—é—á" –ª–∏—à–µ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ñ–æ—Ç–æ.

**–¶–µ —ñ —î —á–∏—Å—Ç–∏–π OAuth2.** –ô–æ–≥–æ –º–µ—Ç–∞ ‚Äî –Ω–∞–¥–∞—Ç–∏ –¥–æ–∑–≤—ñ–ª, –Ω–µ –ø–µ—Ä–µ–¥–∞—é—á–∏ –ø–∞—Ä–æ–ª—å.

---
### ## –î–µ –∂ —Ç—É—Ç OIDC?

–î–æ–¥–∞—Ç–æ–∫ "X" —Ö–æ—á–µ –Ω–µ —Ç—ñ–ª—å–∫–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–æ—Ç–æ, 
–∞ –π –Ω–∞–ø–∏—Å–∞—Ç–∏ –Ω–∞ —Å–≤–æ—ó–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ: **"–í—ñ—Ç–∞—î–º–æ, [–í–∞—à–µ —ñ–º'—è]!"**.

–©–æ–± —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, –π–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏, —Ö—Ç–æ –≤–∏. –Ü –æ—Å—å —Ç—É—Ç –¥–æ OAuth2 –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è **OIDC**.

–ö–æ–ª–∏ –¥–æ–¥–∞—Ç–æ–∫ "X" –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î OIDC, Google –ø—ñ—Å–ª—è –≤–∞—à–æ–≥–æ –¥–æ–∑–≤–æ–ª—É –≤–∏–¥–∞—î –π–æ–º—É **–¥–≤–∞ —Ç–æ–∫–µ–Ω–∏**:
1.  **Access Token** (–≤—ñ–¥ OAuth2) ‚Äî –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–æ—Ç–æ.
2.  **ID Token** (–≤—ñ–¥ OIDC) ‚Äî "—Ü–∏—Ñ—Ä–æ–≤–∏–π –ø–∞—Å–ø–æ—Ä—Ç", —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–∞—Å 
(–≤–∞—à–µ —ñ–º'—è, email —Ç–æ—â–æ).
3. 
---
### \#\# –°–ª–∞–π–¥ 5: Client authentication: OFF. –©–æ —Ç–∞–∫–µ `Client Secret` —ñ –¥–µ –≤—ñ–Ω –º–∞—î –∂–∏—Ç–∏?

–£—è–≤—ñ—Ç—å, —â–æ `client secret` ‚Äî —Ü–µ **–ø–∞—Ä–æ–ª—å –≤–∞—à–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É**. 
–¢–∞–∫ —Å–∞–º–æ, —è–∫ –≤–∏ –Ω–µ —Ö–æ—á–µ—Ç–µ, —â–æ–± —Ö—Ç–æ—Å—å –∑–Ω–∞–≤ –≤–∞—à –æ—Å–æ–±–∏—Å—Ç–∏–π –ø–∞—Ä–æ–ª—å, 
–≤–∏ –Ω–µ —Ö–æ—á–µ—Ç–µ, —â–æ–± —Ö—Ç–æ—Å—å –∑–Ω–∞–≤ –ø–∞—Ä–æ–ª—å –≤–∞—à–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É. 
–¶–µ–π —Å–µ–∫—Ä–µ—Ç –º–∞—î –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –ª–∏—à–µ –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É, 
–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞ –≤–∞—à–æ–º—É **–±–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä—ñ**.

### ## –ü—Ä–æ–±–ª–µ–º–∞ Front-End –¥–æ–¥–∞—Ç–∫—ñ–≤ (SPA)

–ö–æ–¥ –≤–∞—à–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–¥–æ–¥–∞—Ç–∫—É (JavaScript, HTML, CSS) –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è **–≤ –±—Ä–∞—É–∑–µ—Ä—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –±—É–¥—å-—è–∫–∞ –ª—é–¥–∏–Ω–∞ –º–æ–∂–µ:
1.  –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ F12, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞.
2.  –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Sources" –∞–±–æ "–î–∂–µ—Ä–µ–ª–∞".
3.  –ü–æ–±–∞—á–∏—Ç–∏ –≤–µ—Å—å –≤–∞—à JavaScript-–∫–æ–¥.

–Ø–∫—â–æ –≤–∏ –∑–±–µ—Ä–µ–∂–µ—Ç–µ `client secret` —É –∫–æ–¥—ñ –≤–∞—à–æ–≥–æ React –∞–±–æ Angular –¥–æ–¥–∞—Ç–∫—É, 
–±—É–¥—å-—è–∫–∞ –ª—é–¥–∏–Ω–∞ –∑–º–æ–∂–µ –π–æ–≥–æ –∑–Ω–∞–π—Ç–∏, 
—Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —ñ –ø–æ—á–∞—Ç–∏ –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π —à–∫—ñ–¥–ª–∏–≤–∏–π –¥–æ–¥–∞—Ç–æ–∫ –∑–∞ –≤–∞—à. 
–¶–µ –≤–µ–ª–∏—á–µ–∑–Ω–∞ –¥—ñ—Ä–∞ –≤ –±–µ–∑–ø–µ—Ü—ñ.

### ## –†—ñ—à–µ–Ω–Ω—è: –ü—É–±–ª—ñ—á–Ω—ñ —Ç–∞ –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏
Keycloak —Ä–æ–∑–¥—ñ–ª—è—î –∫–ª—ñ—î–Ω—Ç—ñ–≤ –Ω–∞ –¥–≤–∞ —Ç–∏–ø–∏:

* #### **Confidential Client (–ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–∏–π) ‚Äî `Client authentication: ON`**
  * **–•—Ç–æ —Ü–µ?** –ë–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤—ñ—Å–∏, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –≤–∞—à–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ
  * **–ß–æ–º—É?** –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –±–µ–∑–ø–µ—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ `client secret` —É —Å–≤–æ—ó—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö 
  —Ñ–∞–π–ª–∞—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, –∫—É–¥–∏ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø—É —É –∑–≤–∏—á–∞–π–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤. 
  Keycloak –¥–æ–≤—ñ—Ä—è—î —Ç–∞–∫–∏–º –∫–ª—ñ—î–Ω—Ç–∞–º –±—ñ–ª—å—à–µ, 
  –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ —Å–≤–æ—é "–æ—Å–æ–±—É" –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ–∫—Ä–µ—Ç–∞.

* #### **Public Client (–ü—É–±–ª—ñ—á–Ω–∏–π) ‚Äî `Client authentication: OFF`**
    * **–•—Ç–æ —Ü–µ?** Front-End SPA, –º–æ–±—ñ–ª—å–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏.
    * **–ß–æ–º—É?** –í–æ–Ω–∏ –Ω–µ –º–æ–∂—É—Ç—å –±–µ–∑–ø–µ—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç.
    * **–Ø–∫ Keycloak –∫–æ–º–ø–µ–Ω—Å—É—î –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å–µ–∫—Ä–µ—Ç—É?** 
  –î–ª—è –ø—É–±–ª—ñ—á–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ Keycloak –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –Ω–∞ —ñ–Ω—à—ñ, 
  –±—ñ–ª—å—à —Å—É–≤–æ—Ä—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –±–µ–∑–ø–µ–∫–∏. 
  –ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –∑ –Ω–∏—Ö ‚Äî —Ü–µ **—Ç–æ—á–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å 
  `Valid Redirect URIs`**. Keycloak –¥–æ–≤—ñ—Ä—è—î –Ω–µ —Å–∞–º–æ–º—É –∫–ª—ñ—î–Ω—Ç—É, 
  –∞ —Ç–æ–º—É —Ñ–∞–∫—Ç—É, —â–æ –≤—ñ–Ω –ø–æ–≤–µ—Ä–Ω–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–∑ –∫–æ–¥–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó) 
  –ª–∏—à–µ –Ω–∞ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å —Å—Ö–≤–∞–ª–µ–Ω—É, –±–µ–∑–ø–µ—á–Ω—É –∞–¥—Ä–µ—Å—É, —è–∫—É –≤–∏ –≤–∫–∞–∑–∞–ª–∏ —É 
  –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö.

---
–ó–≤—ñ—Å–Ω–æ, –¥–∞–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ —Ä–æ–∑–±–µ—Ä–µ–º–æ, –∑–∞ —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∫–æ–∂–Ω–∞ –∑ —Ü–∏—Ö –æ–ø—Ü—ñ–π.

–¶—ñ –¥–≤—ñ –≥–∞–ª–∫–∏ –≤–º–∏–∫–∞—é—Ç—å –¥–≤–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ä—ñ–∑–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó (–∞–±–æ **"–ø–æ—Ç–æ–∫–∏" / "grant types"** –≤ —Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—ó OAuth2) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤. –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –æ–±–æ—Ö —Ä–æ–±–∏—Ç—å –≤–∞—à–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –±—ñ–ª—å—à –≥–Ω—É—á–∫–∏–º, –∞–ª–µ –≤–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏, –∫–æ–ª–∏ —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏.

---
### ## 1. `Standard flow` (–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –ø–æ—Ç—ñ–∫)

* **–©–æ —Ü–µ?** –¶–µ **Authorization Code Flow**. –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π, –Ω–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π —ñ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –¥–ª—è –≤–µ–±–¥–æ–¥–∞—Ç–∫—ñ–≤, –¥–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∑–∞—î–º–æ–¥—ñ—î —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä.
* **–Ø–∫ –ø—Ä–∞—Ü—é—î?** –¶–µ –ø–æ—Ç—ñ–∫ –∑ **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º (redirect)**.
    1.  –í–∞—à –¥–æ–¥–∞—Ç–æ–∫ –∫–∞–∂–µ: "–•–æ—á—É —É–≤—ñ–π—Ç–∏" —ñ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É Keycloak.
    2.  –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å **–Ω–∞ —Å–∞–π—Ç—ñ Keycloak**. –í–∞—à –¥–æ–¥–∞—Ç–æ–∫ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏—Ç—å —Ü–∏—Ö –¥–∞–Ω–∏—Ö.
    3.  Keycloak –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞–∑–∞–¥ —É –≤–∞—à –¥–æ–¥–∞—Ç–æ–∫ –∑ —Ç–∏–º—á–∞—Å–æ–≤–∏–º **–∫–æ–¥–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**.
    4.  –í–∞—à –±–µ–∫–µ–Ω–¥ –æ–±–º—ñ–Ω—é—î —Ü–µ–π –∫–æ–¥ –Ω–∞ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π **Access Token**.

---
### ## 2. `Direct access grants` (–ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø)

* **–©–æ —Ü–µ?** –¶–µ **Resource Owner Password Credentials Grant** (–∞–±–æ "password grant").
* **–Ø–∫ –ø—Ä–∞—Ü—é—î?** –¶–µ –ø–æ—Ç—ñ–∫ **–±–µ–∑ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**.
    1.  –í–∞—à –¥–æ–¥–∞—Ç–æ–∫ (–∫–ª—ñ—î–Ω—Ç) **—Å–∞–º –∑–±–∏—Ä–∞—î –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ —Å–≤–æ—é —Ñ–æ—Ä–º—É.
    2.  –í—ñ–Ω –Ω–∞–ø—Ä—è–º—É –Ω–∞–¥—Å–∏–ª–∞—î —Ü—ñ –¥–∞–Ω—ñ —Ä–∞–∑–æ–º –∑—ñ —Å–≤–æ—ó–º–∏ `client_id` —Ç–∞ `client_secret` –Ω–∞ —Å–µ—Ä–≤–µ—Ä Keycloak.
    3.  –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å Keycloak –æ–¥—Ä–∞–∑—É –ø–æ–≤–µ—Ä—Ç–∞—î **Access Token**.
* **–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏?**
    * –î–ª—è **—Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** API —á–µ—Ä–µ–∑ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –Ω–∞ –∫—à—Ç–∞–ª—Ç Postman –∞–±–æ `curl` (—è–∫ –º–∏ —Ä–æ–±–∏–ª–∏).
    * –î–ª—è "–≤–∏—Å–æ–∫–æ –¥–æ–≤—ñ—Ä–µ–Ω–∏—Ö" –¥–æ–¥–∞—Ç–∫—ñ–≤, –¥–µ —Ä–µ–¥—ñ—Ä–µ–∫—Ç –Ω–µ–º–æ–∂–ª–∏–≤–∏–π –∞–±–æ –Ω–µ–∑—Ä—É—á–Ω–∏–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–±—ñ–ª—å–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ –≤—ñ–¥ —Ç—ñ—î—ó –∂ –∫–æ–º–ø–∞–Ω—ñ—ó, CLI-—Å–∫—Ä–∏–ø—Ç–∏).
    * –î–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑—ñ —Å—Ç–∞—Ä–∏—Ö —Å–∏—Å—Ç–µ–º, —è–∫—ñ –ø–æ–∫–ª–∞–¥–∞–ª–∏—Å—è –Ω–∞ –ª–æ–≥—ñ–Ω/–ø–∞—Ä–æ–ª—å.
* **–ë–µ–∑–ø–µ–∫–∞:** –¶–µ–π –ø–æ—Ç—ñ–∫ –≤–≤–∞–∂–∞—î—Ç—å—Å—è **–º–µ–Ω—à –±–µ–∑–ø–µ—á–Ω–∏–º**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∞—à –¥–æ–¥–∞—Ç–æ–∫ –æ—Ç—Ä–∏–º—É—î –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –ø–∞—Ä–æ–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —â–æ –∑–±—ñ–ª—å—à—É—î —Ä–∏–∑–∏–∫–∏ —É –≤–∏–ø–∞–¥–∫—É –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó –¥–æ–¥–∞—Ç–∫—É.

---

### \#\# –°–ª–∞–π–¥ 5: –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª —Ç–æ–∫–µ–Ω—ñ–≤: Access —Ç–∞ Refresh

–£ —Å—É—á–∞—Å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–≤–∞ —Ç–∏–ø–∏ —Ç–æ–∫–µ–Ω—ñ–≤:

* **Access Token (–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É)**

    * **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü—Ä–µ–¥'—è–≤–ª—è—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ –¥–æ –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ API.
    * **–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª:** **–ö–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—á–∏–π** (–∑–∞–∑–≤–∏—á–∞–π 5-15 —Ö–≤–∏–ª–∏–Ω). –¶–µ –º—ñ–Ω—ñ–º—ñ–∑—É—î —Ä–∏–∑–∏–∫, —è–∫—â–æ —Ç–æ–∫–µ–Ω –±—É–¥–µ –≤–∫—Ä–∞–¥–µ–Ω–æ.
    * **–í–º—ñ—Å—Ç:** –ú—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –π–æ–≥–æ –ø—Ä–∞–≤–∞ (—Ä–æ–ª—ñ).

* **Refresh Token (–¢–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è)**

    * **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ô–æ–≥–æ —î–¥–∏–Ω–∞ –º–µ—Ç–∞ ‚Äî –±–µ–∑–ø–µ—á–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ **–Ω–æ–≤–∏–π Access Token**, –∫–æ–ª–∏ —Å—Ç–∞—Ä–∏–π –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è.
    * **–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª:** **–î–æ–≤–≥–æ–∂–∏–≤—É—á–∏–π** (–¥–Ω—ñ, —Ç–∏–∂–Ω—ñ, –º—ñ—Å—è—Ü—ñ).
    * **–ë–µ–∑–ø–µ–∫–∞:** –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –Ω–∞–¥—ñ–π–Ω–æ —ñ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –ª–∏—à–µ –Ω–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –µ–Ω–¥–ø–æ—ñ–Ω—Ç –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ Access Token.

---

### \#\# –°–ª–∞–π–¥ 6: –ü–æ—Ä—è–¥–æ–∫ –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¢–æ–∫–µ–Ω—É (Authorization Code Flow)

–¶–µ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π —ñ –Ω–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –¥–ª—è –≤–µ–±–¥–æ–¥–∞—Ç–∫—ñ–≤.

1.  –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞ —Å–∞–π—Ç—ñ –Ω–∞—Ç–∏—Å–∫–∞—î "–£–≤—ñ–π—Ç–∏".
2.  –î–æ–¥–∞—Ç–æ–∫ **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î** –±—Ä–∞—É–∑–µ—Ä –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É Keycloak.
3.  –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å **–Ω–∞ —Å–∞–π—Ç—ñ Keycloak**. –î–æ–¥–∞—Ç–æ–∫ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏—Ç—å —Ü–∏—Ö –¥–∞–Ω–∏—Ö.
4.  Keycloak **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î** –±—Ä–∞—É–∑–µ—Ä –Ω–∞–∑–∞–¥ —É –¥–æ–¥–∞—Ç–æ–∫, –¥–æ–¥–∞–≤—à–∏ –¥–æ URL –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π **–∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**.
5.  **–ë–µ–∫–µ–Ω–¥** –¥–æ–¥–∞—Ç–∫—É –æ–±–º—ñ–Ω—é—î —Ü–µ–π –∫–æ–¥ (—Ä–∞–∑–æ–º –∑—ñ —Å–≤–æ—ó–º —Å–µ–∫—Ä–µ—Ç–æ–º –∫–ª—ñ—î–Ω—Ç–∞) –Ω–∞ **Access Token** —Ç–∞ **Refresh Token**.

---

### \#\# –°–ª–∞–π–¥ 7: –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ Keycloak

–£ —Ç–∏–ø–æ–≤—ñ–π —Å—É—á–∞—Å–Ω—ñ–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ —Ä–æ–ª—ñ —á—ñ—Ç–∫–æ —Ä–æ–∑–¥—ñ–ª–µ–Ω—ñ:

* **Front-End (SPA: React, Angular, Vue)**

    * –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ UI —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.
    * **–Ü–Ω—ñ—Ü—ñ—é—î –ø—Ä–æ—Ü–µ—Å –ª–æ–≥—ñ–Ω—É** (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ Keycloak).
    * **–ó–±–µ—Ä—ñ–≥–∞—î —Ç–æ–∫–µ–Ω–∏** —Ç–∞ –¥–æ–¥–∞—î Access Token –¥–æ –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –Ω–∞ –±–µ–∫–µ–Ω–¥.

* **Back-End (Spring Boot REST API)**

    * –Ñ **–°–µ—Ä–≤–µ—Ä–æ–º –†–µ—Å—É—Ä—Å—ñ–≤**.
    * –ù–µ –∑–∞–π–º–∞—î—Ç—å—Å—è –ª–æ–≥—ñ–Ω–æ–º —á–∏ —Ä–µ–¥—ñ—Ä–µ–∫—Ç–∞–º–∏.
    * **–õ–∏—à–µ –≤–∞–ª—ñ–¥—É—î JWT-—Ç–æ–∫–µ–Ω–∏**, —â–æ –Ω–∞–¥—Ö–æ–¥—è—Ç—å —É –∑–∞–≥–æ–ª–æ–≤–∫—É `Authorization`.

* **Keycloak**

    * –Ñ **–°–µ—Ä–≤–µ—Ä–æ–º –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**.
    * –ö–µ—Ä—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, –ø–∞—Ä–æ–ª—è–º–∏ —Ç–∞ —Ä–æ–ª—è–º–∏.
    * –ù–∞–¥–∞—î —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É —Ç–∞ –≤–∏–¥–∞—î —Ç–æ–∫–µ–Ω–∏.

---

### \#\# –°–ª–∞–π–¥ 8: –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Back-End: –°–µ—Ä–≤–µ—Ä –†–µ—Å—É—Ä—Å—ñ–≤

–¶–µ–π –±–ª–æ–∫ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –≤–∞—à Spring Boot –¥–æ–¥–∞—Ç–æ–∫ –Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≤—Ö—ñ–¥–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤.

```yaml
spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: http://localhost:8081/realms/my-prod-app-realm
```

* **–†–æ–ª—å —Ü—ñ—î—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:** 
* –¶–µ **–Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É API**. 
* –í—ñ–Ω –∫–∞–∂–µ Spring Security, —Ö—Ç–æ —î –¥–æ–≤—ñ—Ä–µ–Ω–∏–º –≤–∏–¥–∞–≤—Ü–µ–º JWT-—Ç–æ–∫–µ–Ω—ñ–≤.

---

### \#\# –°–ª–∞–π–¥ 9: –ú–∞–≥—ñ—è `issuer-uri`

–û—Å—å —â–æ —Å–∞–º–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è "–ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º", –∫–æ–ª–∏ Spring –±–∞—á–∏—Ç—å `issuer-uri`:

1.  **–ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç:** –î–æ –≤–∞—à–æ–≥–æ API –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –∑–∞–ø–∏—Ç —ñ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Authorization: Bearer <JWT>`.

2.  **OIDC Discovery:** Spring Security **–æ–¥–∏–Ω —Ä–∞–∑** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ (–∞–±–æ –∑ –ø–µ–≤–Ω–∏–º –∫–µ—à—É–≤–∞–Ω–Ω—è–º) —Ä–æ–±–∏—Ç—å GET-–∑–∞–ø–∏—Ç –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—é –∞–¥—Ä–µ—Å–æ—é, —è–∫—É –≤—ñ–Ω –±—É–¥—É—î –Ω–∞ –æ—Å–Ω–æ–≤—ñ `issuer-uri`:
    `{issuer-uri}/.well-known/openid-configuration`
    *–ü—Ä–∏–∫–ª–∞–¥: `http://localhost:8081/realms/my-prod-app-realm/.well-known/openid-configuration`*

3.  **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:** –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å Keycloak –ø–æ–≤–µ—Ä—Ç–∞—î JSON-–¥–æ–∫—É–º–µ–Ω—Ç –∑ —É—Å—ñ–º–∞ —Å–≤–æ—ó–º–∏ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∞–º–∏. Spring –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —É –Ω—å–æ–º—É –∫–ª—é—á–æ–≤–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî `jwks_uri`.

4.  **–ó–∞–ø–∏—Ç –Ω–∞ –ø—É–±–ª—ñ—á–Ω—ñ –∫–ª—é—á—ñ (JWKS):** Spring —Ä–æ–±–∏—Ç—å –¥—Ä—É–≥–∏–π GET-–∑–∞–ø–∏—Ç, —Ç–µ–ø–µ—Ä —É–∂–µ –Ω–∞ –∞–¥—Ä–µ—Å—É, –≤–∫–∞–∑–∞–Ω—É –≤ `jwks_uri`.

5.  **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤:** –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å Keycloak –ø–æ–≤–µ—Ä—Ç–∞—î JSON-–º–∞—Å–∏–≤ –ø—É–±–ª—ñ—á–Ω–∏—Ö –∫–ª—é—á—ñ–≤ (JSON Web Key Set), —è–∫–∏–º–∏ –≤—ñ–Ω –ø—ñ–¥–ø–∏—Å—É—î —Ç–æ–∫–µ–Ω–∏. –ö–æ–∂–µ–Ω –∫–ª—é—á –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä (`kid`).

6.  **–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—É:**

    * Spring —Ä–æ–∑–±–∏—Ä–∞—î –≤—Ö—ñ–¥–Ω–∏–π JWT —ñ –¥–∏–≤–∏—Ç—å—Å—è –Ω–∞ –π–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫, —â–æ–± –∑–Ω–∞–π—Ç–∏ `kid` –∫–ª—é—á–∞, —è–∫–∏–º —Ç–æ–∫–µ–Ω –±—É–≤ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π.
    * –í—ñ–Ω –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–º—É —Å–ø–∏—Å–∫—É –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –∑ —Ç–∞–∫–∏–º —Å–∞–º–∏–º `kid`.
    * –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ü—å–æ–≥–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤—ñ–Ω –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ü–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å —Ç–æ–∫–µ–Ω—É.

7.  **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –Ø–∫—â–æ –ø—ñ–¥–ø–∏—Å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π, Spring –¥–æ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω—É —ñ –¥–æ–∑–≤–æ–ª—è—î –æ–±—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç. –Ø–∫—â–æ –Ω—ñ ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ–º–∏–ª–∫—É `401 Unauthorized`.

---

### \#\# –°–ª–∞–π–¥ 10: –†–æ–∑–±—ñ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –†–æ–ª–µ–π

```java
private JwtAuthenticationConverter jwtAuthenticationConverter() {
    JwtAuthenticationConverter jwtConverter = new JwtAuthenticationConverter();
    jwtConverter.setJwtGrantedAuthoritiesConverter(jwt -> {
        Map<String, Collection<String>> realmAccess = jwt.getClaim("realm_access");
        if (realmAccess == null || realmAccess.isEmpty()) return List.of();
        return realmAccess.get("roles").stream()
                .map(role -> new SimpleGrantedAuthority("ROLE_" + role))
                .collect(Collectors.toList());
    });
    return jwtConverter;
}
```

* **–ü—Ä–æ–±–ª–µ–º–∞:** Keycloak –∑–±–µ—Ä—ñ–≥–∞—î –≥–ª–æ–±–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É –≤–∫–ª–∞–¥–µ–Ω—ñ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ JWT: `realm_access.roles`. Spring Security –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–µ –∑–Ω–∞—î, —è–∫ —ó—Ö –∑–≤—ñ–¥—Ç–∏ –¥—ñ—Å—Ç–∞—Ç–∏.
* **–†–æ–ª—å —Ü—ñ—î—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:** –¶–µ–π –±—ñ–Ω –≤–∏—Å—Ç—É–ø–∞—î –≤ —Ä–æ–ª—ñ **"–ø–µ—Ä–µ–∫–ª–∞–¥–∞—á–∞"**, —è–∫–∏–π "–Ω–∞–≤—á–∞—î" Spring Security, –¥–µ —Å–∞–º–µ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–æ–∫–µ–Ω—É —à—É–∫–∞—Ç–∏ —Ä–æ–ª—ñ —Ç–∞ —è–∫ —ó—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ (–¥–æ–¥–∞—é—á–∏ –ø—Ä–µ—Ñ—ñ–∫—Å `ROLE_`).

---

### \#\# –°–ª–∞–π–¥ 11: –†–æ–∑–±—ñ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó: –©–æ —Ç–∞–∫–µ CORS?

**CORS (Cross-Origin Resource Sharing)** ‚Äî —Ü–µ –º–µ—Ö–∞–Ω—ñ–∑–º –±–µ–∑–ø–µ–∫–∏, –≤–±—É–¥–æ–≤–∞–Ω–∏–π —É –±—Ä–∞—É–∑–µ—Ä–∏, —è–∫–∏–π –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **–±–ª–æ–∫—É—î** HTTP-–∑–∞–ø–∏—Ç–∏ –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ "–¥–∂–µ—Ä–µ–ª–∞–º–∏" (origins).

* **Origin (–¥–∂–µ—Ä–µ–ª–æ)** = `—Å—Ö–µ–º–∞ (http) + —Ö–æ—Å—Ç (localhost) + –ø–æ—Ä—Ç (3000)`.
* –ó–∞–ø–∏—Ç –∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –Ω–∞ `http://localhost:3000` –¥–æ –±–µ–∫–µ–Ω–¥—É –Ω–∞ `http://localhost:8080` ‚Äî —Ü–µ **cross-origin –∑–∞–ø–∏—Ç**, —ñ –≤—ñ–Ω –±—É–¥–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π.
* **–ê–Ω–∞–ª–æ–≥—ñ—è:** –ü–æ–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –∑–∞–±–æ—Ä–æ–Ω—è—î –¥–∑–≤–æ–Ω–∏—Ç–∏ –∑ –æ–¥–Ω–æ–≥–æ –±—É–¥–∏–Ω–∫—É (–¥–æ–º–µ–Ω—É) –≤ —ñ–Ω—à–∏–π –±–µ–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –¥–æ–∑–≤–æ–ª—É.

---

### \#\# –°–ª–∞–π–¥ 12: –†–æ–∑–±—ñ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CORS

–¶–µ–π –±—ñ–Ω –Ω–∞–¥–∞—î –±–µ–∫–µ–Ω–¥—É –¥–æ–∑–≤—ñ–ª –ø—Ä–∏–π–º–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ –≤–∞—à–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É.

```java
@Bean
public CorsConfigurationSource corsConfigurationSource() {
    CorsConfiguration configuration = new CorsConfiguration();
    // –î–æ–∑–≤–æ–ª—è—î–º–æ –∑–∞–ø–∏—Ç–∏ –∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É
    configuration.setAllowedOrigins(List.of("http://localhost:3000"));
    // –î–æ–∑–≤–æ–ª—è—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ HTTP –º–µ—Ç–æ–¥–∏
    configuration.setAllowedMethods(List.of("GET", "POST", "PUT", "DELETE"));
    // –î–æ–∑–≤–æ–ª—è—î–º–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ Authorization —Ç–∞ Content-Type
    configuration.setAllowedHeaders(List.of("Authorization", "Content-Type"));
    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
    source.registerCorsConfiguration("/**", configuration);
    return source;
}
```

* **–†–æ–ª—å —Ü—ñ—î—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:** –¶–µ **–∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∞** —á–∞—Å—Ç–∏–Ω–∞ –¥–ª—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏, –¥–µ Front-End —Ç–∞ Back-End –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø–æ—Ä—Ç–∞—Ö –∞–±–æ –¥–æ–º–µ–Ω–∞—Ö. –ë–µ–∑ –Ω–µ—ó –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –∑–º–æ–∂–µ "–¥–æ—Å—Ç—É–∫–∞—Ç–∏—Å—è" –¥–æ –±–µ–∫–µ–Ω–¥—É.

---

### \#\# –°–ª–∞–π–¥ 13: –ü—ñ–¥—Å—É–º–æ–∫

* **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** ‚Äî —Ü–µ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ—Å–æ–±–∏, **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤.
* **OAuth2 + OIDC** ‚Äî —Å—É—á–∞—Å–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –≤—Ö–æ–¥—É —Ç–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ API.
* `issuer-uri` ‚Äî —Ü–µ –∫–ª—é—á –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ç–æ–∫–µ–Ω—ñ–≤ —É Spring Security.
* **–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ä–æ–ª–µ–π** —Ç–∞ **CORS** ‚Äî –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤ –∑ Keycloak —Ç–∞ —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º.